(function(g){var a=function(){function u(h){this.name=h;this.supportedLanguages=[];this.aboutDialog="";this.settings={};this.version=0;var e=d.$;this.onRender=function(){};this.onRun=function(){};this.register=function(){a.registerPlugin(this.name,this)};this.run=function(){this.onRun(e)};this.render=function(){this.onRender(e)}}function m(){j("waitForLib invoked");a.internal.__loadAttempts==a.internal.__maxLoadAttempts?(j("Max load count reached: stopping execution."),bar=document.getElementById("sbarGhost"),
bar.innerHTML=d.__templates.barFailed,setTimeout(function(){body=document.getElementsByTagName("body");bar=document.getElementById("sbarGhost");body[0].removeChild(bar)},a.internal.__errorMessageTimeout)):"undefined"==typeof g.jQuery||null==g.jQuery?(j("waitForLib: jQuery undefined."),setTimeout(function(){m()},100),a.internal.__loadAttempts++):(d.$=g.jQuery.noConflict(!0),"undefined"!=typeof g._jQuery&&(g.jQuery=g._jQuery),"undefined"!=typeof g._$&&(g.$=g._$),n(),d.$(document).ready(function(){l()}))}
function n(){"undefined"==typeof d.$.facebox&&d.addScript(a.internal.__assetURL+"js/facebox.min.js")}function l(){j("broadcastLoaded fired.");g.AtKit=d;"undefined"!=typeof g.AtKitLoaded&&g.AtKitLoaded.fire(null,{version:a.internal.__version})}function q(h){j("renderButton fired for ident "+h+".");var e=d.__templates.button,e=e.replace(/\(ID\)/ig,h),e=e.replace(/\(TITLE\)/ig,d.__env.buttons[h].tooltip),e=e.replace(/\(SRC\)/ig,d.__env.buttons[h].icon),e=d.$(e);e.children("a").bind("click",{button:d.__env.buttons[h]},
function(e){try{d.__env.buttons[h].action(e.data.button.dialogs,e.data.button.functions)}catch(g){a.internal.__debug&&j(g)}e.preventDefault()});e.children("a").bind("focus",function(){d.$(this).attr("style",d.$(this).attr("style")+d.__CSS[".at-btn a:active"])});e.children("a").bind("focusout",function(){d.$(this).attr("style",d.__CSS[".at-btn a"])});d.__env.buttons[h].HTML=e;return d.__env.buttons[h].HTML}function k(h){h="undefined"==typeof h?d.__CSS:h;for(c in h)if(!(/:active/.test(c)||0==d.$(c).length))try{var a=
h[c];if(d.settings.isRightToLeft)if(-1!=a.indexOf("float:left"))var g=RegExp("float:left","gi"),a=a.replace(g,"float:right");else-1!=a.indexOf("float:right")&&(g=RegExp("float:right","gi"),a=a.replace(g,"float:left"));d.$(c).attr("style",a)}catch(k){j(k.description)}}function j(d){a.internal.__debug&&(null!=a.internal.debugCallback?a.internal.debugCallback(d):"undefined"!=typeof console&&console.log(d))}function r(){barGhost=document.createElement("div");barGhost.id="sbarGhost";barGhost.innerHTML=
d.__templates.barGhost;if(null!=document.body)document.body.insertBefore(barGhost,document.body.firstChild);else var h=setInterval(function(){null!=document.body&&(document.body.insertBefore(barGhost,document.body.firstChild),clearInterval(h))},100)}function t(d,a){var g=document.createElement("script");g.src=a;g.type="text/javascript";g.id=d;document.getElementsByTagName("head")[0].appendChild(g)}a.internal=a.prototype={__version:1.2,__build:1,__APIVersion:1,__baseURL:"https://core.atbar.org/",__APIURL:"http://a.atbar.org/",
__pluginURL:"https://plugins.atbar.org/",__libURL:"https://core.atbar.org/resources/jquery/1.8/jquery.min.js",__channel:"atkit",__invoked:!1,__debug:!1,__loadAttempts:0,__maxLoadAttempts:30,__errorMessageTimeout:2E3,__localStorageNamespace:"AtKit_",__protocol:null,plugins:{},localisations:{en:{exit:"Exit",reset:"Reset webpage"}},templates:{global:{buttons:{},dialogs:{},storage:{},fn:{},unloadFn:{},resetFn:{},closeFn:{}}},debugCallback:null,language:"en",defaultLanguage:"en"};a.internal.__resourceURL=
a.internal.__baseURL;a.internal.__channelURL+=a.internal.__channel;a.internal.__assetURL=a.internal.__baseURL+"resources/";a.internal.versionString="v"+a.internal.__version.toFixed(1)+"."+a.internal.__build+" ("+a.internal.__channel+" release channel)";a.internal.__aboutDialog={CSS:{"#ATKFBAbout":"font-family:Helvetica, Verdana, Arial, sans-serif;font-size:12px;color:#364365;","#ATKFBAbout h2":"border-bottom:1px solid #DDD;font-size:16px;margin-bottom:5px;margin-top:10px;padding-bottom:5px","#ATKFBAbout p#ATKFBAboutFooter":"border-top:1px solid #DDD;padding-top:10px;margin-top:25px;"}};
a.external=a.prototype={transport:"JSONP",window:g,global:a.internal.templates.global,buttons:{},languageMap:{},siteFixes:[]};var d={__env:a.external,__templates:{barGhost:'<center><img src="'+a.internal.__assetURL+'img/loading.gif" style="margin-top:10px;" /></center>',barFailed:"<center>library loading failed</center>",button:'<div id="at-btn-(ID)" title="(TITLE)" class="at-btn"><a title="(TITLE)" id="at-lnk-(ID)" href="#ATBarLink"><img src="(SRC)" alt="(TITLE)" height="16" width="16" border="0" /></a></div>',
spacer:'<div class="at-spacer"></div>',separator:'<div class="at-separator"></div>'},__CSS:{"#sbar":"height:40px;left:0;line-height:40px;margin-left:auto;margin-right:auto;margin-top:0;position:fixed;top:0;width:100%;z-index:2147483646;padding:0 5px;background:url("+a.internal.__assetURL+"img/background.png) repeat-x #EBEAED;","#sbarGhost":"height:40px;width:100%;",".at-spacer":"display:block;height:40px;width:40px;float:left",".at-separator":"display:block;height:25px;float:left;border-left:2px solid #a9a9a9;margin:7px 1px 4px 7px",
".at-btn":"height:28px;width:28px;float:left;line-height:14px;text-align:center;color:#FFF;clear:none;margin:5px 0 0 5px;background:url("+a.internal.__assetURL+"img/button_background.png) no-repeat",".at-btn a":"display:block;height:28px;width:28px;background:transparent;position:inherit;",".at-btn a:active":"border:yellow solid 2px;",".at-btn img":"margin:0;padding:6px;border:none;background:none;","#at-btn-atkit-reset, #at-btn-atkit-unload":"height:28px;width:28px;line-height:14px;text-align:center;color:#FFF;clear:none;float:right;margin:5px 10px 0 0;background:url("+
a.internal.__assetURL+"img/button_background.png) no-repeat;","#facebox button":"height:26px;margin:10px;padding:5px;color:white;background-color:#0064CD;border-color:rgba(0,0,0,0.1) rgba(0,0,0,0.1) rgba(0,0,0,0.25);text-shadow:0 -1px 0 rgba(0,0,0,0.25);background-image: -webkit-linear-gradient(top, #049cdb, #0064cd);border-radius:4px","#facebox h2":"font-size:18pt;font-weight:bold;color:black"},settings:{noiframe:!0,allowclose:!0,allowreset:!0,isRightToLeft:!1,logoURL:"",name:"",about:""},version:a.internal.__APIVersion,
$:"",plugin:function(d){return new u(d)},getVersion:function(){return a.internal.__version.toFixed(1)+"."+a.internal.__build},isRendered:function(){return a.internal.__invoked},g:function(){return a.internal.__resourceURL},getResourceURL:function(){return a.internal.__resourceURL},getChannelURL:function(){return a.internal.__channelURL},getPluginURL:function(){return a.internal.__pluginURL},setName:function(a){d.settings.name=a},setAbout:function(a){d.settings.about=a},setLogo:function(a){d.settings.logoURL=
a},setIsRightToLeft:function(a){d.settings.isRightToLeft=a},setCSS:function(a,e){d.__CSS[a]=e},setIsRightToLeft:function(a){d.settings.isRightToLeft=a},setLanguage:function(d){a.internal.language=d},getLanguage:function(){return a.internal.language},addLocalisation:function(d,e,g){a.internal.localisations[d][e]=g},addLocalisationMap:function(h,e){a.internal.localisations[h]=d.$.extend(!0,a.internal.localisations[h],e)},localisation:function(d){return"undefined"==typeof a.internal.localisations[a.internal.language]?
a.internal.localisations[a.internal.defaultLanguage][d]:"undefined"==typeof a.internal.localisations[a.internal.language][d]?"{no value set for key "+d+" in language "+a.internal.language+"}":a.internal.localisations[a.internal.language][d]},addFix:function(a,e){d.__env.siteFixes.push({regex:a,f:e})},addScript:function(a,e){"undefined"!=typeof d.$?0<d.$('script[src="'+a+'"]').length||d.$.getScript(a,e):t("",a)},addStylesheet:function(a,e){d.$("head").append(d.$("<link>",{rel:"stylesheet",href:a,type:"text/css",
id:e}))},addFn:function(a,e){d.__env.global.fn[a]=e},addCloseFn:function(a,e){d.__env.global.closeFn[a]=e},addResetFn:function(a,e){d.__env.global.resetFn[a]=e},addDialog:function(a,e,g){d.__env.global.dialogs[a]={title:e,body:g}},addButton:function(h,e,g,j,m,n,l){"undefined"==typeof d.__env.buttons[h]&&(d.__env.buttons[h]={icon:g,tooltip:e,action:j,dialogs:m,functions:n},null!=l&&(d.__env.buttons[h]=d.$.extend(!0,d.__env.buttons[h],l)),a.internal.__invoked&&(d.$(q(h)).appendTo("#sbar"),k()))},removeButton:function(h){delete d.__env.buttons[h];
a.internal.__invoked&&(j("remove button "+h),d.$("#at-btn-"+h).remove())},addSpacer:function(a){"undefined"==typeof a&&d.$(d.__templates.spacer).appendTo("#sbar");if(!isNaN(a))for(i=0;i<a;i++)d.$(d.__templates.spacer).appendTo("#sbar");k()},addSeparator:function(){d.$(d.__templates.separator).appendTo("#sbar");k()},importPlugins:function(h,e){var g=h instanceof Array?h.join(","):h;d.addScript(a.internal.__pluginURL+g+".js",e)},addPlugin:function(d){a.internal.plugins[d].payload()},registerPlugin:function(d,
e,g){a.internal.plugins[d]={payload:e,metadata:g}},listPlugins:function(){var d=[];for(p in a.internal.plugins)d.push(p);return d},getPluginMetadata:function(d){return a.internal.plugins[d].metadata},show:function(a,e){a=d.$("<div>",{"class":"userDialog"}).append(d.$("<h2>",{html:a.title}),d.$("<p>",{html:a.body}));d.$("body").find(".facebox_hide").remove();d.$.facebox(a);k();"null"!=typeof e&&"undefined"!=typeof e&&e()},message:function(a,e){d.$("body").find(".facebox_hide").remove();d.$.facebox(a);
k();"null"!=typeof e&&"undefined"!=typeof e&&e()},hideDialog:function(){d.$(g.document).trigger("close.facebox")},call:function(a,e){return d.__env.global.fn[a](e)},set:function(a,e){d.__env.global.storage[a]=e},get:function(a){return d.__env.global.storage[a]},storageAvailable:function(){return typeof g.localStorage?!0:!1},storage:function(h,e){if(!d.storageAvailable())return!1;var j=a.internal.__localStorageNamespace+d.settings.name+"_"+h;if("undefined"==typeof e)return g.localStorage.getItem(j);
g.localStorage.setItem(j,e);return!0},clearStorage:function(){if(d.storageAvailable()){var h=RegExp("^"+(a.internal.__localStorageNamespace+d.settings.name)+".*");for(s in g.localStorage)s.match(h)&&g.localStorage.removeItem(s)}},setDebugger:function(d){a.internal.debugCallback=d},lib:function(){return"function"==typeof d.$?d.$:"string"==typeof d.$&&"function"==typeof g.jQuery?g.jQuery:!1},render:function(){if(!a.internal.__invoked){0==d.$("#sbarGhost").length&&r();d.$(d.$("<div>",{id:"sbar"})).insertAfter("#sbarGhost");
var g=d.settings.isRightToLeft?"right":"left";d.$(d.$("<a>",{id:"sbarlogo",click:function(){a.internal.__aboutDialog.HTML="<h2>About "+d.settings.name+"</h2>";a.internal.__aboutDialog.HTML+="<p id='ATKFBUserSpecifiedAbout'>"+d.settings.about+"</p>";a.internal.__aboutDialog.HTML+="<p id='ATKFBAboutFooter'>Powered by AtKit "+a.internal.versionString;var e=d.listPlugins();0<e.length&&(a.internal.__aboutDialog.HTML+="<br /> Registered plugins: ",e.map(function(d){a.internal.__aboutDialog.HTML+="<button class='pluginLink'>"+
d+"</button>"}));a.internal.__aboutDialog.HTML+="</p>";a.internal.__aboutDialog.HTML=d.$("<div>",{id:"ATKFBAbout"}).append(a.internal.__aboutDialog.HTML);d.message(a.internal.__aboutDialog.HTML);k(a.internal.__aboutDialog.CSS)}}).append(d.$("<img>",{src:d.settings.logoURL,align:g,border:"0",title:d.settings.name+"Logo",alt:d.settings.name+"Logo",style:"margin-top:10px;float:"+g}))).appendTo("#sbar");d.$("<img>",{src:"https://misc.services.atbar.org/stats/stat.php?channel="+a.internal.__channel+"-"+
d.settings.name+"&version="+a.internal.__version.toFixed(1)+"."+a.internal.__build,alt:" "}).appendTo("#sbar");d.settings.allowclose&&d.addButton("atkit-unload",d.localisation("exit"),a.internal.__assetURL+"img/close.png",function(){d.close()},null,null,{cssClass:"fright"});d.settings.allowreset&&d.addButton("atkit-reset",d.localisation("reset"),a.internal.__assetURL+"img/reset.png",function(){d.reset()},null,null,{cssClass:"fright"});for(b in d.__env.buttons)d.$(q(b)).appendTo("#sbar");k();j("siteFixes fired. Running fixes.");
if(0!=d.__env.siteFixes.length)for(fix in d.__env.siteFixes)g=d.__env.siteFixes[fix],g.regex.test()&&g.f();"msie"==d.$.browser&&6==d.$.browser.version?d.$("#sbarGhost").remove():d.$("#sbarGhost").html("&nbsp;");a.internal.__invoked=!0;d.__env.global.unloadFn["default"]=function(){d.$("#sbarGhost, #sbar").remove()};d.__env.global.resetFn["default"]=function(){location.reload(!0)};d.$("body").trigger("AtKitRenderComplete")}},close:function(){for(f in d.__env.global.unloadFn)d.__env.global.unloadFn[f]();
a.internal.language=a.internal.defaultLanguage;a.internal.debugCallback=null;d.__env.global=a.internal.templates.global;d.__env.buttons={};d.__env.languageMap={};d.__env.siteFixes=[];a.internal.plugins={};a.internal.__invoked=!1},reset:function(){for(f in d.__env.global.resetFn)d.__env.global.resetFn[f]();a.internal.__invoked=!1}};j("bootstrapping AtKit "+a.internal.versionString+"...");if(null==document.getElementById("sbar")&&!a.internal.__invoked&&!(d.settings.noiframe&&g!=g.top)){"undefined"!=
typeof g.AtKitLoaded&&r();"undefined"==typeof unsafeWindow?a.external.window=g:(a.external.window=unsafeWindow,a.external.transport="GM-XHR");b:{j("loadLibrary called");if("undefined"!=typeof g.jQuery)try{jQversion=parseFloat(g.jQuery().jquery.match(/\d\.\d/));j("jQuery already loaded, v"+jQversion);if(1.5<jQversion){j("loaded version acceptable, using.");d.$=g.jQuery;n();l();break b}g._jQuery=g.jQuery;g.jQuery=null}catch(v){}else"undefined"!=typeof g.$&&(g._$=g.$);a.internal.__debug&&(newVersion=
parseFloat(a.internal.__libURL.match(/\d\.\d/)),j("jQuery not loaded, loading "+newVersion));t("atkit-jquery",a.internal.__libURL);m()}}return d};g.AtKit=new a})(window);