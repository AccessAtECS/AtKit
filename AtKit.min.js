(function(g){var d=function(){function m(){j("waitForLib invoked");d.internal.__loadAttempts==d.internal.__maxLoadAttempts?(j("Max load count reached: stopping execution."),u()):"undefined"==typeof g.jQuery||null==g.jQuery?(j("waitForLib: jQuery undefined."),setTimeout(function(){m()},100),d.internal.__loadAttempts++):(a.$=g.jQuery.noConflict(!0),"undefined"!=typeof g._jQuery&&(g.jQuery=g._jQuery),"undefined"!=typeof g._$&&(g.$=g._$),n(),a.$(document).ready(function(){l()}))}function n(){"undefined"==
typeof a.$.facebox&&a.addScript(d.internal.__baseURL+"atkit/facebox.min.js")}function l(){j("broadcastLoaded fired.");g.AtKit=a;"undefined"!=typeof g.AtKitLoaded&&g.AtKitLoaded.fire(null,{version:d.internal.__version})}function v(){j("siteFixes fired. Running fixes.");if(0!=a.__env.siteFixes.length)for(fix in a.__env.siteFixes){var h=a.__env.siteFixes[fix];h.regex.test()&&h.f()}}function o(h){j("renderButton fired for ident "+h+".");var e=a.__templates.button,e=e.replace(/\(ID\)/ig,h),e=e.replace(/\(TITLE\)/ig,
a.__env.buttons[h].tooltip),e=e.replace(/\(SRC\)/ig,a.__env.buttons[h].icon),e=a.$(e);e.children("a").bind("click",{button:a.__env.buttons[h]},function(e){try{a.__env.buttons[h].action(e.data.button.dialogs,e.data.button.functions)}catch(g){d.internal.__debug&&j(g)}e.preventDefault()});e.children("a").bind("focus",function(){a.$(this).attr("style",a.$(this).attr("style")+a.__CSS[".at-btn a:active"])});e.children("a").bind("focusout",function(){a.$(this).attr("style",a.__CSS[".at-btn a"])});a.__env.buttons[h].HTML=
e;return a.__env.buttons[h].HTML}function w(){if(!d.internal.__invoked){0==a.$("#sbarGhost").length&&q();a.$(a.$("<div>",{id:"sbar"})).insertAfter("#sbarGhost");a.$(a.$("<a>",{id:"sbarlogo",click:function(){d.internal.__aboutDialog.HTML="<h2>About "+a.settings.name+"</h2>";d.internal.__aboutDialog.HTML+="<p id='ATKFBUserSpecifiedAbout'>"+a.settings.about+"</p>";d.internal.__aboutDialog.HTML+="<p id='ATKFBAboutFooter'>Powered by <a href='http://kit.atbar.org/'>AtKit</a> "+d.internal.versionString;
/https:/.test(r())&&(d.internal.__aboutDialog.HTML+="<br />Running in secure (SSL) mode");var h=a.listPlugins();0<h.length&&(d.internal.__aboutDialog.HTML+="<br /> Registered plugins: "+h.join(", "));d.internal.__aboutDialog.HTML+="</p>";d.internal.__aboutDialog.HTML=a.$("<div>",{id:"ATKFBAbout"}).append(d.internal.__aboutDialog.HTML);a.message(d.internal.__aboutDialog.HTML);k(d.internal.__aboutDialog.CSS)}}).append(a.$("<img>",{src:a.settings.logoURL,align:"left",border:"0",title:a.settings.name+
"Logo",style:"float:left;margin-top:10px;"}))).appendTo("#sbar");a.$("<img>",{src:d.internal.__APIURL+"stat.php?channel="+d.internal.__channel+"-"+a.settings.name+"&version="+d.internal.__version.toFixed(1)+"."+d.internal.__build}).appendTo("#sbar");a.settings.allowclose&&a.addButton("atkit-unload","Exit",d.internal.__assetURL+"images/close.png",function(){a.close()},null,null,{cssClass:"fright"});a.settings.allowreset&&a.addButton("atkit-reset","Reset webpage",d.internal.__assetURL+"images/reset.png",
function(){a.reset()},null,null,{cssClass:"fright"});for(b in a.__env.buttons)a.$(o(b)).appendTo("#sbar");k();v();"msie"==a.$.browser&&6==a.$.browser.version?a.$("#sbarGhost").remove():a.$("#sbarGhost").html("&nbsp;");d.internal.__invoked=!0;a.__env.global.unloadFn["default"]=function(){a.$("#sbarGhost, #sbar").remove()};a.__env.global.resetFn["default"]=function(){location.reload(!0)};a.$("body").trigger("AtKitRenderComplete")}}function k(h){h="undefined"==typeof h?a.__CSS:h;for(c in h)if(!(/:active/.test(c)||
0==a.$(c).length))try{a.$(c).attr("style",h[c])}catch(d){j(d.description)}}function r(){if(null!=d.internal.__protocol)return d.internal.__protocol;d.internal.__protocol=g.location.protocol;return d.internal.__protocol}function j(a){d.internal.__debug&&(null!=d.internal.debugCallback?d.internal.debugCallback(a):"undefined"!=typeof console&&console.log(a))}function q(){barGhost=document.createElement("div");barGhost.id="sbarGhost";barGhost.innerHTML=a.__templates.barGhost;if(null!=document.body)document.body.insertBefore(barGhost,
document.body.firstChild);else var h=setInterval(function(){null!=document.body&&(document.body.insertBefore(barGhost,document.body.firstChild),clearInterval(h))},100)}function t(a,d){var g=document.createElement("script");g.src=d;g.type="text/javascript";g.id=a;document.getElementsByTagName("head")[0].appendChild(g)}function u(){bar=document.getElementById("sbarGhost");bar.innerHTML=a.__templates.barFailed;setTimeout(function(){body=document.getElementsByTagName("body");bar=document.getElementById("sbarGhost");
body[0].removeChild(bar)},d.internal.__errorMessageTimeout)}d.internal=d.prototype={__version:1,__build:247,__baseURL:"http://c.atbar.org/",__APIURL:"http://a.atbar.org/",__pluginURL:"http://plugins.atbar.org/",__libURL:"http://ajax.googleapis.com/ajax/libs/jquery/1.7/jquery.min.js",__channel:"atkit",__invoked:!1,__debug:!1,__loadAttempts:0,__maxLoadAttempts:30,__errorMessageTimeout:2E3,__localStorageNamespace:"AtKit_",__protocol:null,plugins:{},localisations:{},debugCallback:null,language:"GB",defaultLanguage:"GB"};
d.internal.__resourceURL=d.internal.__baseURL;d.internal.__resourceURL+=d.internal.__channel;d.internal.__assetURL=d.internal.__resourceURL+"/presentation/";d.internal.versionString="v"+d.internal.__version.toFixed(1)+"."+d.internal.__build+" ("+d.internal.__channel+" release channel)";d.internal.__aboutDialog={CSS:{"#ATKFBAbout":"font-family:Helvetica, Verdana, Arial, sans-serif;font-size:12px;color:#364365;","#ATKFBAbout h2":"border-bottom:1px solid #DDD;font-size:16px;margin-bottom:5px;margin-top:10px;padding-bottom:5px",
"#ATKFBAbout p#ATKFBAboutFooter":"border-top:1px solid #DDD;padding-top:10px;margin-top:25px;"}};d.external=d.prototype={transport:"JSONP",window:g,global:{buttons:{},dialogs:{},storage:{},fn:{},unloadFn:{},resetFn:{}},buttons:{},languageMap:{},siteFixes:[]};var a={__env:d.external,__templates:{barGhost:'<center><img src="'+d.internal.__assetURL+'images/loading.gif" style="margin-top:10px;" /></center>',barFailed:"<center>library loading failed</center>",button:'<div id="at-btn-(ID)" title="(TITLE)" class="at-btn"><a title="(TITLE)" id="at-lnk-(ID)" href="#ATBarLink"><img src="(SRC)" alt="(TITLE)" height="16" width="16" border="0" /></a></div>',
spacer:'<div class="at-spacer"></div>',separator:'<div class="at-separator"></div>'},__CSS:{"#sbar":"height:40px;left:0;line-height:40px;margin-left:auto;margin-right:auto;margin-top:0;position:fixed;top:0;width:100%;z-index:9999998;padding:0 5px;background:url("+d.internal.__assetURL+"images/background.png) repeat-x #EBEAED;","#sbarGhost":"height:40px;width:100%;",".at-spacer":"display:block;height:40px;width:40px;float:left",".at-separator":"display:block;height:25px;float:left;border-left:2px solid #a9a9a9;margin:7px 1px 4px 7px",
".at-btn":"height:28px;width:28px;float:left;line-height:14px;text-align:center;color:#FFF;clear:none;margin:5px 0 0 5px;background:url("+d.internal.__assetURL+"images/button_background.png) no-repeat",".at-btn a":"display:block;height:28px;width:28px;background:transparent;position:inherit;",".at-btn a:active":"border:yellow solid 2px;",".at-btn img":"margin:0;padding:6px;border:none;background:none;","#at-btn-atkit-reset, #at-btn-atkit-unload":"height:28px;width:28px;line-height:14px;text-align:center;color:#FFF;clear:none;float:right;margin:5px 10px 0 0;background:url("+
d.internal.__assetURL+"images/button_background.png) no-repeat;","#facebox button":"height:26px;margin:10px;padding:5px;color:white;background-color:#0064CD;border-color:rgba(0,0,0,0.1) rgba(0,0,0,0.1) rgba(0,0,0,0.25);text-shadow:0 -1px 0 rgba(0,0,0,0.25);background-image: -webkit-linear-gradient(top, #049cdb, #0064cd);border-radius:4px","#facebox h2":"font-size:18pt;font-weight:bold;color:black"},settings:{noiframe:!0,allowclose:!0,allowreset:!0,logoURL:"",name:"",about:""},$:""};(function(){var a=
r();/https:/.test(a)&&(d.internal.__libURL=d.internal.__libURL.replace("http:",a),d.internal.__baseURL="https://ssl.atbar.org/c/",d.internal.__APIURL="https://ssl.atbar.org/a/",d.internal.__pluginURL="https://ssl.atbar.org/plugins/")})();a.getVersion=function(){return d.internal.__version.toFixed(1)+"."+d.internal.__build};a.isRendered=function(){return d.internal.__invoked};a.getResourceURL=function(){return d.internal.__resourceURL};a.getPluginURL=function(){return d.internal.__pluginURL};a.setName=
function(d){a.settings.name=d};a.setAbout=function(d){a.settings.about=d};a.setLogo=function(d){a.settings.logoURL=d};a.setCSS=function(d,e){a.__CSS[d]=e};a.setLanguage=function(a){d.internal.language=a};a.getLanguage=function(){return d.internal.language};a.addLocalisation=function(a,e,g){d.internal.localisations[a][e]=g};a.addLocalisationMap=function(h,e){d.internal.localisations[h]=a.$.extend(!0,d.internal.localisations[h],e)};a.localisation=function(a){return"undefined"==typeof d.internal.localisations[d.internal.language]?
d.internal.localisations[d.internal.defaultLanguage][a]:"undefined"==typeof d.internal.localisations[d.internal.language][a]?"{no value set for key "+a+" in language "+d.internal.language+"}":d.internal.localisations[d.internal.language][a]};a.addFix=function(d,e){a.__env.siteFixes.push({regex:d,f:e})};a.addScript=function(d,e){"undefined"!=typeof a.$?0<a.$('script[src="'+d+'"]').length||a.$.getScript(d,e):t("",d)};a.addStylesheet=function(d,e){a.$("head").append(a.$("<link>",{rel:"stylesheet",href:d,
type:"text/css",id:e}))};a.addFn=function(d,e){a.__env.global.fn[d]=e};a.addCloseFn=function(d,e){a.__env.global.closeFn[d]=e};a.addResetFn=function(d,e){a.__env.global.resetFn[d]=e};a.addDialog=function(d,e,g){a.__env.global.dialogs[d]={title:e,body:g}};a.addButton=function(h,e,g,j,m,n,l){"undefined"==typeof a.__env.buttons[h]&&(a.__env.buttons[h]={icon:g,tooltip:e,action:j,dialogs:m,functions:n},null!=l&&(a.__env.buttons[h]=a.$.extend(!0,a.__env.buttons[h],l)),d.internal.__invoked&&(a.$(o(h)).appendTo("#sbar"),
k()))};a.removeButton=function(h){delete a.__env.buttons[h];d.internal.__invoked&&(j("remove button "+h),a.$("#at-btn-"+h).remove())};a.addSpacer=function(d){"undefined"==typeof d&&a.$(a.__templates.spacer).appendTo("#sbar");if(!isNaN(d))for(i=0;i<d;i++)a.$(a.__templates.spacer).appendTo("#sbar");k()};a.addSeparator=function(){a.$(a.__templates.separator).appendTo("#sbar");k()};a.importPlugins=function(h,e){var g=h instanceof Array?h.join(","):h;a.addScript(d.internal.__pluginURL+g+".js",e)};a.addPlugin=
function(a){d.internal.plugins[a].payload()};a.registerPlugin=function(a,e,g){d.internal.plugins[a]={payload:e,metadata:g}};a.listPlugins=function(){var a=[];for(p in d.internal.plugins)a.push(p);return a};a.getPluginMetadata=function(a){return d.internal.plugins[a].metadata};a.show=function(d,e){d=a.$("<div>",{"class":"userDialog"}).append(a.$("<h2>",{html:d.title}),a.$("<p>",{html:d.body}));a.$("body").find(".facebox_hide").remove();a.$.facebox(d);k();"null"!=typeof e&&"undefined"!=typeof e&&e()};
a.message=function(d,e){a.$("body").find(".facebox_hide").remove();a.$.facebox(d);k();"null"!=typeof e&&"undefined"!=typeof e&&e()};a.hideDialog=function(){a.$(g.document).trigger("close.facebox")};a.call=function(d,e){return a.__env.global.fn[d](e)};a.set=function(d,e){a.__env.global.storage[d]=e};a.get=function(d){return a.__env.global.storage[d]};a.storageAvailable=function(){return typeof g.localStorage?!0:!1};a.storage=function(h,e){if(!a.storageAvailable())return!1;var j=d.internal.__localStorageNamespace+
a.settings.name+"_"+h;if("undefined"==typeof e)return g.localStorage.getItem(j);g.localStorage.setItem(j,e);return!0};a.clearStorage=function(){if(a.storageAvailable()){var h=RegExp("^"+(d.internal.__localStorageNamespace+a.settings.name)+".*");for(s in g.localStorage)s.match(h)&&g.localStorage.removeItem(s)}};a.setDebugger=function(a){d.internal.debugCallback=a};a.lib=function(){return"function"==typeof a.$?a.$:"string"==typeof a.$&&"function"==typeof g.jQuery?g.jQuery:!1};a.render=function(){w()};
a.close=function(){for(f in a.__env.global.unloadFn)a.__env.global.unloadFn[f]();d.internal.__invoked=!1};a.reset=function(){for(f in a.__env.global.resetFn)a.__env.global.resetFn[f]();d.internal.__invoked=!1};j("bootstrapping AtKit "+d.internal.versionString+"...");if(!(null!=document.getElementById("sbar")||d.internal.__invoked||a.settings.noiframe&&g!=g.top)){"undefined"!=typeof g.AtKitLoaded&&q();"undefined"==typeof unsafeWindow?d.external.window=g:(d.external.window=unsafeWindow,d.external.transport=
"GM-XHR");b:{j("loadLibrary called");if("undefined"!=typeof g.jQuery)try{jQversion=parseFloat(g.jQuery().jquery.match(/\d\.\d/));j("jQuery already loaded, v"+jQversion);if(1.5<jQversion){j("loaded version acceptable, using.");a.$=g.jQuery;n();l();break b}g._jQuery=g.jQuery;g.jQuery=null}catch(x){}else"undefined"!=typeof g.$&&(g._$=g.$);d.internal.__debug&&(newVersion=parseFloat(d.internal.__libURL.match(/\d\.\d/)),j("jQuery not loaded, loading "+newVersion));t("atkit-jquery",d.internal.__libURL);
m()}}return a};g.AtKit=new d})(window);